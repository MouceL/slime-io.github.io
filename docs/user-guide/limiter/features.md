1. 方便使用，只需提交`SmartLimiter`资源即可达到服务限流的目的。
2. 自适应限流，根据`pod`的资源使用量动态的触发限流规则。
3. 覆盖场景多，网格入口流量限流，网关出口流量限流
4. 支持功能多，支持全局共享限流，全局均分限流，单机限流。

------

## 思路
slime/limiter 组件监听smartlimiter资源，自动生成包含限流规则的envoyfilter。

- 对于网格场景，envoyfilter会下发给作为sidecar的envoy,在envoy的入口进行限流判断。
- 对于网关场景，envoyfilter被下发给作为router的envoy，在envoy的出口进行限流判断。

## 功能

目前slime/limiter模块支持以下几个类型的限流：

网格场景下：

1. 支持单机限流：对于指定的服务的每一个pod,都有一个固定的限流数值，使用的限流插件是http.local_ratelimit（限流计数器在本地)
2. 支持全局均分限流：服务的所有pod，平均分配限流数，使用的限流插件是http.local_ratelimit（限流计数器在本地)
3. 支持全局共享限流：服务的所有pod, 共享一个限流计数器，使用的限流插件是http.ratelimit（限流计数器在远端)

网关场景下：
1. 支持单机限流
2. 支持全局共享限流


网格网关场景下支持限流类型如下

|      | 单机限流 | 全局均分限流 | 全局共享 |
| ---- | -------- | ------------ | -------- |
| 网格 | 支持     | 支持         | 支持     |
| 网关 | 支持     | -            | 支持     |

网格网关场景下支持限流方向如下

|      | 入方向限流 | 出方向限流               |
| ---- | ---------- | ------------------------ |
| 网格 | 支持       | 部分支持（单机限流） |
| 网关 | -          | 支持                     |

网格网关场景下一些功能的差异如下

|      | headerMatch | host限流 | serviceEntry |
| ---- | ---------------- | ---------- | ------------ |
| 网格 | 支持             | -          | 支持         |
| 网关 | 支持             | 支持       | -            |
